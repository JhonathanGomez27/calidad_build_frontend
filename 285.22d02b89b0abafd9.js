"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[285],{9285:(z,C,i)=>{i.r(C),i.d(C,{default:()=>J});var c=i(6223),T=i(2296),f=i(8034),u=i(4170),Z=i(617),h=i(1476),o=i(5313),p=i(553),w=i(3519),g=i.n(w),b=i(8645),v=i(9773),A=i(5940),S=i(1474),M=i(6676),Y=i.n(M),t=i(9212),N=i(5619),U=i(9397);let x=(()=>{class e{constructor(){this.url=p.N.url,this.limit=p.N.pagination,this._statistics=new N.X(null),this._httpCliente=(0,t.f3M)(S.eN)}get statistics$(){return this._statistics.asObservable()}getStatistics(a){return this._httpCliente.get(`${this.url}statistics`,{params:a}).pipe((0,U.b)(n=>{this._statistics.next(n)}))}static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var I=i(5407);function R(e,m){1&e&&(t.TgZ(0,"th",24),t._uU(1," Nombre "),t.qZA())}function F(e,m){if(1&e&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&e){const a=m.$implicit;t.xp6(),t.hij(" ",a.usuarionombre," ")}}function Q(e,m){1&e&&(t.TgZ(0,"th",24),t._uU(1," Minutos calidad "),t.qZA())}function j(e,m){if(1&e&&(t.TgZ(0,"td",25),t._uU(1),t.qZA()),2&e){const a=m.$implicit;t.xp6(),t.hij(" ",a.totaltranscripciones,"")}}function P(e,m){1&e&&t._UZ(0,"tr",26)}function $(e,m){1&e&&t._UZ(0,"tr",27)}function E(e,m){1&e&&(t.TgZ(0,"div",28)(1,"p",29),t._uU(2,"No hay estadisticas para mostrar"),t.qZA()())}const J=[{path:"",component:(()=>{class e{constructor(a,n){this._statisticsService=a,this._changeDetectorRef=n,this._unsubscribeAll=new b.x,this.range=new c.cw({start:new c.NI(Y()()),end:new c.NI(Y()())}),this.statistics=[],this.totalStatistics=0,this.page=0,this.limit=p.N.pagination,this.loading=!1,this.displayedColumns=["nombre","transcripciones"],this.dataSource=new o.by([]),this.Toast=g().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:s=>{s.addEventListener("mouseenter",g().stopTimer),s.addEventListener("mouseleave",g().resumeTimer)}})}ngOnInit(){this._statisticsService.statistics$.pipe((0,v.R)(this._unsubscribeAll)).subscribe(a=>{this.statistics=a.usuarios,this.totalStatistics=a.total,this.dataSource=new o.by(this.statistics),this.loading=!1,this._changeDetectorRef.markForCheck()}),this.range.valueChanges.pipe((0,v.R)(this._unsubscribeAll)).subscribe(a=>{a.start&&a.end&&(a.start.isAfter(a.end)?(this.Toast.fire({icon:"error",title:"La fecha de inicio no puede ser mayor a la fecha de fin"}),this.range.get("start")?.setValue(null),this.range.get("end")?.setValue(null)):(this.paginator.pageIndex=0,this.handlePageEvent({pageIndex:0,pageSize:this.limit,length:this.totalStatistics})))})}handlePageEvent(a){this.loading=!0;const n=a.pageIndex+1,s=this.range.get("start")?.value,r=this.range.get("end")?.value;let l=new S.LE;l=l.append("page",n.toString()),l=l.append("limit",this.limit.toString()),s&&(l=l.append("fechaInicio",this.convertDateToYYYYMMDD(s))),r&&(l=l.append("fechaFin",this.convertDateToYYYYMMDD(r))),this._statisticsService.getStatistics(l).pipe((0,v.R)(this._unsubscribeAll)).subscribe()}convertDateToYYYYMMDD(a){return a.format("YYYY-MM-DD")}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(x),t.Y36(t.sBO))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-statistics"]],viewQuery:function(n,s){if(1&n&&t.Gf(h.NW,7),2&n){let r;t.iGM(r=t.CRH())&&(s.paginator=r.first)}},standalone:!0,features:[t.jDz],decls:32,vars:10,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto","bg-white"],[1,"flex-auto","p-6","sm:px-26","sm:py-10"],[1,"min-h-100"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-center","items-start","mb-6","w-full"],[1,"text-4xl","font-semibold","text-primary-700"],[1,"w-full","md:w-1/3"],["appearance","fill",1,"w-full","mb-4"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","start","placeholder","Start date","readonly",""],["matEndDate","","formControlName","end","placeholder","End date","readonly",""],["matIconSuffix","",3,"for"],["picker",""],[1,"overflow-x-auto"],["mat-table","",1,"w-full",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","transcripciones"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","flex justify-center items-center w-full h-64"],[1,"w-full","flex","justify-end"],["aria-label","Seleccionar pagina de estadisticas","showFirstLastButtons","true",3,"length","pageSize","disabled","page"],["paginator",""],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"flex","justify-center","items-center","w-full","h-64"],[1,"text-gray-500"]],template:function(n,s){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),t._uU(5,"Consolidado minutos"),t.qZA()(),t.TgZ(6,"div",5)(7,"mat-form-field",6)(8,"mat-label"),t._uU(9,"Ingresa una fecha de busqueda"),t.qZA(),t.TgZ(10,"mat-date-range-input",7),t._UZ(11,"input",8)(12,"input",9),t.qZA(),t.TgZ(13,"mat-hint"),t._uU(14,"MM/DD/YYYY \u2013 MM/DD/YYYY"),t.qZA(),t._UZ(15,"mat-datepicker-toggle",10)(16,"mat-date-range-picker",null,11),t.qZA()(),t.TgZ(18,"div",12)(19,"table",13),t.ynx(20,14),t.YNc(21,R,2,0,"th",15)(22,F,2,1,"td",16),t.BQk(),t.ynx(23,17),t.YNc(24,Q,2,0,"th",15)(25,j,2,1,"td",16),t.BQk(),t.YNc(26,P,1,0,"tr",18)(27,$,1,0,"tr",19),t.qZA()(),t.YNc(28,E,3,0,"div",20),t.TgZ(29,"div",21)(30,"mat-paginator",22,23),t.NdJ("page",function(l){return s.handlePageEvent(l)}),t.qZA()()()()()),2&n){const r=t.MAs(17);t.xp6(10),t.Q6J("formGroup",s.range)("rangePicker",r),t.xp6(5),t.Q6J("for",r),t.xp6(4),t.Q6J("dataSource",s.dataSource),t.xp6(7),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(),t.um2(28,0===s.totalStatistics?28:-1),t.xp6(2),t.Q6J("length",s.totalStatistics)("pageSize",s.limit)("disabled",s.loading)}},dependencies:[o.p0,o.BZ,o.fO,o.as,o.w1,o.Dz,o.nj,o.ge,o.ev,o.XQ,o.Gk,Z.Ps,T.ot,f.FA,I.PQ,f.nW,f.wx,f.zY,f.By,f._g,c.u5,c.Fj,c.JJ,c.JL,c.UX,c.sg,c.u,h.TU,h.NW,u.lN,u.KE,u.hX,u.bx,u.R9,A.Cq],encapsulation:2,changeDetection:0})}return e})(),resolve:{statistics:(e,m)=>{const a=e.queryParams.page||1,n=p.N.pagination;let s=e.queryParams.fechaInicio||null,r=e.queryParams.fechaFin||null;if(!s){const d=new Date,y=String(d.getDate()).padStart(2,"0"),D=String(d.getMonth()+1).padStart(2,"0");s=`${d.getFullYear()}-${D}-${y}`}if(!r){const d=new Date,y=String(d.getDate()).padStart(2,"0"),D=String(d.getMonth()+1).padStart(2,"0");r=`${d.getFullYear()}-${D}-${y}`}const l=(new S.LE).set("page",a).set("limit",n).set("fechaInicio",s).set("fechaFin",r);return(0,t.f3M)(x).getStatistics(l)}}}]}}]);